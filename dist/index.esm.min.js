var n={props:{closeOnSelect:{type:Boolean,required:!1,default:function(){return!0}},disableSearch:{type:Boolean,required:!1,default:function(){return!1}},label:{type:String,required:!1,default:function(){return"label"}},minChars:{type:Number,required:!1,default:function(){return 3}},options:{type:Array,required:!1,default:function(){return[]}},placeholder:{type:String,required:!1,default:function(){return"Search..."}},showList:{type:Boolean,required:!1,default:function(){return!0}},tabCompletion:{type:Boolean,required:!1,default:function(){return!0}}},data:function(){return{currentSearch:"",listPosition:-1,isOpenList:!0,isInputFocused:!1}},computed:{completion:function(){var n=this,e=new RegExp("^("+this.currentSearch+")(.+)","i");return this.options.reduce((function(t,i){var o=i[n.label].match(e);return""===n.currentSearch?"":""==t&&o||o&&i.length<t.length?o[2]:t}),"")},filteredOptions:function(){var n=this,e=new RegExp("^"+this.currentSearch,"i"),t=this.options.filter((function(t){return t[n.label].match(e)}));return this.disableSearch?this.options:t}},methods:{focusInput:function(){var n=this.$refs.input,e=document.createRange(),t=window.getSelection(),i=n.childNodes[0];e.setStart(i,i.textContent.length),e.collapse(!0),t.removeAllRanges(),t.addRange(e),n.focus()},getTextContent:function(n){return void 0===n&&(n=this.$refs.input),[].reduce.call(n.childNodes,(function(n,e){return n+(3===e.nodeType?e.textContent:"")}),"")},runSpecialKeys:function(n){"Tab"===n.code&&this.tabCompletion?(n.preventDefault(),this.currentSearch+=this.completion,this.setTextContent(this.currentSearch),this.focusInput()):"ArrowDown"===n.code?(n.preventDefault(),this.listPosition<this.filteredOptions.length-1&&(this.listPosition+=1)):"ArrowUp"===n.code?(n.preventDefault(),this.listPosition>-1&&(this.listPosition-=1)):"Enter"===n.code&&(n.preventDefault(),this.listPosition>-1?this.selectCurrentOption():this.triggerSearch())},selectCurrentOption:function(n){void 0===n&&(n=this.filteredOptions[this.listPosition]),this.currentSearch=n[this.label],this.setTextContent(this.currentSearch),this.listPosition=-1,this.$emit("selected",n),this.isOpenList=!this.closeOnSelect,this.focusInput()},setTextContent:function(n,e){void 0===e&&(e=this.$refs.input),e.childNodes[0].textContent=n},triggerSearch:function(){this.$emit("searched",this.currentSearch),this.isOpenList=!this.closeOnSelect},updateValue:function(n){var e=n.target,t=this.getTextContent(e);this.currentSearch=t,this.isOpenList=!0}},mounted:function(){var n=this.$refs.input,e=document.createTextNode("");n.prepend(e)}};function e(n,e,t,i,o,s,r,a,l,d){"boolean"!=typeof r&&(l=a,a=r,r=!1);var c,A="function"==typeof t?t.options:t;if(n&&n.render&&(A.render=n.render,A.staticRenderFns=n.staticRenderFns,A._compiled=!0,o&&(A.functional=!0)),i&&(A._scopeId=i),s?(c=function(n){(n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(n=__VUE_SSR_CONTEXT__),e&&e.call(this,l(n)),n&&n._registeredComponents&&n._registeredComponents.add(s)},A._ssrRegister=c):e&&(c=r?function(n){e.call(this,d(n,this.$root.$options.shadowRoot))}:function(n){e.call(this,a(n))}),c)if(A.functional){var u=A.render;A.render=function(n,e){return c.call(e),u(n,e)}}else{var h=A.beforeCreate;A.beforeCreate=h?[].concat(h,c):[c]}return t}var t,i="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function o(n){return function(n,e){return function(n,e){var o=i?e.media||"default":n,r=s[o]||(s[o]={ids:new Set,styles:[]});if(!r.ids.has(n)){r.ids.add(n);var a=e.source;if(e.map&&(a+="\n/*# sourceURL="+e.map.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),r.element||(r.element=document.createElement("style"),r.element.type="text/css",e.media&&r.element.setAttribute("media",e.media),void 0===t&&(t=document.head||document.getElementsByTagName("head")[0]),t.appendChild(r.element)),"styleSheet"in r.element)r.styles.push(a),r.element.styleSheet.cssText=r.styles.filter(Boolean).join("\n");else{var l=r.ids.size-1,d=document.createTextNode(a),c=r.element.childNodes;c[l]&&r.element.removeChild(c[l]),c.length?r.element.insertBefore(d,c[l]):r.element.appendChild(d)}}}(n,e)}}var s={};var r=n,a=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"om-root"},[t("div",{staticClass:"om-search-container",class:{"om-has-focus":n.isInputFocused}},[t("button",{staticClass:"om-search",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),n.triggerSearch(e)}}},[t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16"}},[t("path",{attrs:{"fill-rule":"evenodd",d:"M15.7 13.3l-3.81-3.83A5.93 5.93 0 0013 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 000-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"}})])]),n._v(" "),t("div",{ref:"input",staticClass:"om-input single-line",class:{"width--auto":n.isInputFocused,"width--start":n.isInputFocused&&0===n.currentSearch.length,"width--full":!n.isInputFocused&&n.currentSearch.length>0},attrs:{contenteditable:"true"},on:{input:function(e){return e.stopPropagation(),n.updateValue(e)},keydown:function(e){return e.stopPropagation(),n.runSpecialKeys(e)},focusin:function(e){n.isInputFocused=!0},focusout:function(e){n.isInputFocused=!1}}}),n._v(" "),0!==n.currentSearch.length||n.isInputFocused?n._e():t("span",{staticClass:"om-placeholder",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),n.focusInput(e)}}},[n._v(n._s(n.placeholder))]),n._v(" "),t("span",{directives:[{name:"show",rawName:"v-show",value:n.isInputFocused,expression:"isInputFocused"}],staticClass:"om-completion",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),n.focusInput(e)}}},[n._v(n._s(n.completion))])]),n._v(" "),t("div",{staticClass:"om-list-container"},[n.currentSearch.length>=n.minChars&&n.showList&&n.isOpenList&&n.filteredOptions.length>0&&n.isInputFocused?t("div",{staticClass:"om-list"},n._l(n.filteredOptions,(function(e,i){return t("div",{key:e[n.label],staticClass:"om-list-item",class:{"om-highlight":i===n.listPosition},on:{mousedown:function(t){return t.stopPropagation(),t.preventDefault(),n.selectCurrentOption(e)}}},[n._t("option",[n._v("\n          "+n._s(e[n.label])+"\n        ")],{option:e})],2)})),0):n._e()])])};a._withStripped=!0;var l=e({render:a,staticRenderFns:[]},(function(n){n&&n("data-v-de6d2fa6_0",{source:'\n*[data-v-de6d2fa6] {\n  box-sizing: border-box;\n}\n.om-root[data-v-de6d2fa6] {\n  position: relative;\n}\n.om-input[data-v-de6d2fa6] {\n  display: inline-block;\n  height: 28px;\n  vertical-align: middle;\n  line-height: 28px;\n}\n.om-input[data-v-de6d2fa6]:focus {\n  border: none;\n  outline: none;\n}\n.om-completion[data-v-de6d2fa6] {\n  height: 100%;\n  width: auto;\n  max-width: 100%;\n  color: lightgray;\n  overflow: hidden;\n  line-height: 28px;\n  white-space: pre;\n}\n[contenteditable="true"].single-line[data-v-de6d2fa6] {\n  white-space: pre;\n  overflow: hidden;\n}\n[contenteditable="true"].single-line br[data-v-de6d2fa6] {\n  display:none;\n}\n[contenteditable="true"].single-line *[data-v-de6d2fa6] {\n  display:inline;\n  white-space:nowrap;\n}\n.width--auto[data-v-de6d2fa6] {\n  width: auto;\n  max-width: calc(100% - 35px);\n}\n.width--full[data-v-de6d2fa6] {\n  width: calc(100% - 35px);\n}\n.width--start[data-v-de6d2fa6] {\n  min-width: 10px;\n}\n.om-placeholder[data-v-de6d2fa6] {\n  display: inline-block;\n  height: 100%;\n  width: 100%;\n  line-height: 28px;\n  color: darkgray;\n}\n.om-list-container[data-v-de6d2fa6] {\n  position: relative;\n}\n.om-list[data-v-de6d2fa6] {\n  position: absolute;\n  width: 100%;\n  border-left: 1px solid lightgray;\n  border-right: 1px solid lightgray;\n  border-bottom: 1px solid lightgray;\n  padding: 4px 8px;\n  background-color: white;\n  z-index: 1001;\n}\n.om-highlight[data-v-de6d2fa6] {\n  background-color: lightgrey;\n}\n.om-list-item[data-v-de6d2fa6] {\n  font-weight: 500;\n  cursor: pointer;\n}\n.om-list-item[data-v-de6d2fa6]:hover {\n  background-color: lightgray;\n}\n.om-search[data-v-de6d2fa6] {\n  vertical-align: middle;\n  background-color: transparent;\n  border: none;\n}\n.om-search-container[data-v-de6d2fa6] {\n  border: 1px solid lightgray;\n  display: flex;\n  padding: 4px 8px;\n  border-radius: 3px;\n}\n.om-has-focus[data-v-de6d2fa6] {\n  border: 2px solid navy;\n}\n',map:{version:3,sources:["/home/mathis/Development/vue-omnibox/src/Omnibox.vue"],names:[],mappings:";AAyLA;EACA,sBAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,qBAAA;EACA,YAAA;EACA,sBAAA;EACA,iBAAA;AACA;AAEA;EACA,YAAA;EACA,aAAA;AACA;AACA;EACA,YAAA;EACA,WAAA;EACA,eAAA;EACA,gBAAA;EACA,gBAAA;EACA,iBAAA;EACA,gBAAA;AACA;AACA;EACA,gBAAA;EACA,gBAAA;AACA;AACA;EACA,YAAA;AAEA;AACA;EACA,cAAA;EACA,kBAAA;AACA;AAEA;EACA,WAAA;EACA,4BAAA;AACA;AAEA;EACA,wBAAA;AACA;AAEA;EACA,eAAA;AACA;AAEA;EACA,qBAAA;EACA,YAAA;EACA,WAAA;EACA,iBAAA;EACA,eAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,kBAAA;EACA,WAAA;EACA,gCAAA;EACA,iCAAA;EACA,kCAAA;EACA,gBAAA;EACA,uBAAA;EACA,aAAA;AACA;AACA;EACA,2BAAA;AACA;AACA;EACA,gBAAA;EACA,eAAA;AACA;AAEA;EACA,2BAAA;AACA;AAEA;EACA,sBAAA;EACA,6BAAA;EACA,YAAA;AACA;AAEA;EACA,2BAAA;EACA,aAAA;EACA,gBAAA;EACA,kBAAA;AACA;AAEA;EACA,sBAAA;AACA",file:"Omnibox.vue",sourcesContent:['<template>\n  <div class="om-root">\n    <div\n      class="om-search-container"\n      :class="{ \'om-has-focus\': isInputFocused }">\n      <button type="button" class="om-search" @click.prevent="triggerSearch">\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0013 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 000-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>\n      </button>\n      <div\n        ref="input"\n        class="om-input single-line"\n        :class="{\n          \'width--auto\': isInputFocused,\n          \'width--start\': isInputFocused && currentSearch.length === 0,\n          \'width--full\': !isInputFocused && currentSearch.length > 0 }"\n        contenteditable="true"\n        @input.stop="updateValue"\n        @keydown.stop="runSpecialKeys"\n        @focusin="isInputFocused = true"\n        @focusout="isInputFocused = false">\n      </div>\n      <span\n        v-if="currentSearch.length === 0 && !isInputFocused"\n        @click.stop.prevent="focusInput"\n        class="om-placeholder">{{ placeholder }}</span>\n      <span\n        v-show="isInputFocused"\n        class="om-completion"\n        @click.stop.prevent="focusInput">{{ completion }}</span>\n    </div>\n    <div class="om-list-container">\n      <div class="om-list" v-if="currentSearch.length >= minChars && showList && isOpenList && filteredOptions.length > 0 && isInputFocused">\n        <div\n          v-for="(option, idx) in filteredOptions"\n          class="om-list-item"\n          :class="{ \'om-highlight\': idx === listPosition }"\n          :key="option[label]"\n          @mousedown.stop.prevent="selectCurrentOption(option)">\n          <slot name="option" v-bind:option="option">\n            {{ option[label] }}\n          </slot>\n        </div>\n    </div>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  props: {\n    closeOnSelect: {\n      type: Boolean,\n      required: false,\n      default: () => true\n    },\n    disableSearch: {\n      type: Boolean,\n      required: false,\n      default: () => false\n    },\n    label: {\n      type: String,\n      required: false,\n      default: () => \'label\'\n    },\n    minChars: {\n      type: Number,\n      required: false,\n      default: () => 3\n    },\n    options: {\n      type: Array,\n      required: false,\n      default: () => ([])\n    },\n    placeholder: {\n      type: String,\n      required: false,\n      default: () => \'Search...\'\n    },\n    showList: {\n      type: Boolean,\n      required: false,\n      default: () => true\n    },\n    tabCompletion: {\n      type: Boolean,\n      required: false,\n      default: () => true\n    }\n  },\n  data () {\n    return {\n      currentSearch: \'\',\n      listPosition: -1,\n      isOpenList: true,\n      isInputFocused: false\n    }\n  },\n  computed: {\n    completion () {\n      const reg = new RegExp(`^(${this.currentSearch})(.+)`, \'i\')\n      return this.options.reduce((acc, val) => {\n        const isMatching = val[this.label].match(reg)\n        if (this.currentSearch === \'\') return \'\'\n        if (acc == \'\' && isMatching) return isMatching[2]\n        if (isMatching && val.length < acc.length) return isMatching[2]\n        return acc\n      }, \'\')\n    },\n    filteredOptions () {\n      const reg = new RegExp(`^${this.currentSearch}`, \'i\')\n      const filtered = this.options.filter(o => o[this.label].match(reg))\n      return this.disableSearch ? this.options : filtered\n    }\n  },\n  methods: {\n    focusInput () {\n      const el = this.$refs.input\n      let range = document.createRange()\n      let sel = window.getSelection()\n      let node = el.childNodes[0]\n      range.setStart(node, node.textContent.length)\n      range.collapse(true)\n      sel.removeAllRanges()\n      sel.addRange(range)\n      el.focus()\n    },\n    getTextContent (el = this.$refs.input) {\n      return [].reduce.call(el.childNodes, function(a, b) { return a + (b.nodeType === 3 ? b.textContent : \'\'); }, \'\')\n    },\n    runSpecialKeys (e) {\n      if (e.code === \'Tab\' && this.tabCompletion) {\n        e.preventDefault()\n        this.currentSearch += this.completion\n        this.setTextContent(this.currentSearch)\n        this.focusInput()\n      } else if (e.code === \'ArrowDown\') {\n        e.preventDefault()\n        if (this.listPosition < this.filteredOptions.length - 1) {\n          this.listPosition += 1\n        }\n      } else if (e.code === "ArrowUp") {\n          e.preventDefault()\n          if (this.listPosition > -1) {\n            this.listPosition -= 1\n          }\n      } else if (e.code === \'Enter\') {\n        e.preventDefault()\n        if (this.listPosition > -1) {\n          this.selectCurrentOption()\n        } else {\n          this.triggerSearch()\n        }\n      }\n    },\n    selectCurrentOption (option = this.filteredOptions[this.listPosition]) {\n      this.currentSearch = option[this.label]\n      this.setTextContent(this.currentSearch)\n      this.listPosition = -1\n      this.$emit(\'selected\', option)\n      this.isOpenList = !this.closeOnSelect\n      this.focusInput()\n    },\n    setTextContent (value, el = this.$refs.input) {\n      el.childNodes[0].textContent = value\n    },\n    triggerSearch () {\n      this.$emit(\'searched\', this.currentSearch)\n      this.isOpenList = !this.closeOnSelect\n    },\n    updateValue (e) {\n      const el = e.target\n      const content = this.getTextContent(el)\n      this.currentSearch = content\n      this.isOpenList = true\n    }\n  },\n  mounted () {\n    const el = this.$refs.input\n    const txt = document.createTextNode(\'\')\n    el.prepend(txt)\n  }\n}\n<\/script>\n<style scoped>\n  * {\n    box-sizing: border-box;\n  }\n  .om-root {\n    position: relative;\n  }\n  .om-input {\n    display: inline-block;\n    height: 28px;\n    vertical-align: middle;\n    line-height: 28px;\n  }\n\n  .om-input:focus {\n    border: none;\n    outline: none;\n  }\n  .om-completion {\n    height: 100%;\n    width: auto;\n    max-width: 100%;\n    color: lightgray;\n    overflow: hidden;\n    line-height: 28px;\n    white-space: pre;\n  }\n  [contenteditable="true"].single-line {\n    white-space: pre;\n    overflow: hidden;\n  } \n  [contenteditable="true"].single-line br {\n    display:none;\n\n  }\n  [contenteditable="true"].single-line * {\n    display:inline;\n    white-space:nowrap;\n  }\n\n  .width--auto {\n    width: auto;\n    max-width: calc(100% - 35px);\n  }\n\n  .width--full {\n    width: calc(100% - 35px);\n  }\n\n  .width--start {\n    min-width: 10px;\n  }\n\n  .om-placeholder {\n    display: inline-block;\n    height: 100%;\n    width: 100%;\n    line-height: 28px;\n    color: darkgray;\n  }\n  .om-list-container {\n    position: relative;\n  }\n  .om-list {\n    position: absolute;\n    width: 100%;\n    border-left: 1px solid lightgray;\n    border-right: 1px solid lightgray;\n    border-bottom: 1px solid lightgray;\n    padding: 4px 8px;\n    background-color: white;\n    z-index: 1001;\n  }\n  .om-highlight {\n    background-color: lightgrey;\n  }\n  .om-list-item {\n    font-weight: 500;\n    cursor: pointer;\n  }\n\n  .om-list-item:hover {\n    background-color: lightgray;\n  }\n\n  .om-search {\n    vertical-align: middle;\n    background-color: transparent;\n    border: none;\n  }\n\n  .om-search-container {\n    border: 1px solid lightgray;\n    display: flex;\n    padding: 4px 8px;\n    border-radius: 3px;\n  }\n\n  .om-has-focus {\n    border: 2px solid navy;\n  }\n</style>\n']},media:void 0})}),r,"data-v-de6d2fa6",!1,void 0,!1,o,void 0,void 0);function d(n){d.installed||(d.installed=!0,n.component("Omnibox",component))}var c={install:d},A=null;"undefined"!=typeof window?A=window.Vue:"undefined"!=typeof global&&(A=global.Vue),A&&A.use(c);export default l;export{d as install};
